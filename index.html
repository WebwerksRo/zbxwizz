<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/select2.min.css">
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/css/jsoneditor.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
    <style>
        #worksheets{
            font-family: "SUSE", sans-serif;
            font-optical-sizing: auto;
            font-style: normal;
        }
        .compress{
            /*width: 50px !important;*/
            max-width: 70px !important;
        }
        .pre{
            background-color: rgb(199, 201, 211);
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 5px;
        }

    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark d-flex fixed-top">
        <div class="flex-grow-1">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link active btn btn-secondary" href="#" role="button" data-toggle="modal" data-target="#importCsvModal">Import CSV</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active btn btn-secondary" href="#" role="button" data-toggle="modal" data-target="#importZbxModal">Import from ZBX</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active btn btn-secondary" href="#" onclick="save_data()">Save CSV</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active btn btn-secondary" href="#" role="button" data-toggle="modal" data-target="#pullZbxModal">ZBX pull</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active btn btn-secondary" href="#" role="button" data-toggle="modal" data-target="#pushZbxModal">ZBX push</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active btn btn-secondary" href="#" role="button" onclick="dt.load_data({records:[],fields:[]})">Clear data</a>
                </li>
            </ul>
        </div>
        <div><a class="nav-link" href="#"  role="button" data-toggle="modal" data-target="#zbxConfigModal"><img src="assets/zbx_logo.png" width="30" id="zbxLogo" class="notConnected" alt="API Conn"></a></div>
    </nav>
    <div class="d-none" style="margin-top: 46px;margin-bottom: 45px">
        <table id="preview" cellpadding="2">
            <thead></thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="modal" id="pullZbxModal">
        <form id="pullZbxForm">
            <div class="modal-dialog modal-dialog-scrollable modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Pull data from Zabbix</h5>
                    </div>
                    <div class="modal-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-group ">
                                    <label>Resource</label>
                                    <select class="custom-select custom-select-sm" name="resource">
                                        <option>host</option>
                                        <option>hostgroup</option>
                                        <option>template</option>
                                        <option>item</option>
                                        <option>history</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label>Post process</label>
                                    <select class="custom-select custom-select-sm mt-1" name="postprocess">
                                        <option value="update">Update existing</option>
                                        <option value="new">New data</option>
                                        <option value="ignore">Ignore</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label>Data label</label>
                                    <input type="text" name="label" value="zbx">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Request templates</label>
                            <div class="input-group mb-2">
                                <select class="custom-select" onchange="load_req_tpl(pullReqTplEditor,$(this).val())" id="pullReqTemplates" name="templates"></select>
                                <div class="input-group-append">
                                    <div class="btn-group">
                                        <button class="btn btn-success" onclick="save_req_tpl(pullReqTplPfx,'#pullReqTemplates',pullReqTplEditor)" type="button">Save</button>
                                        <button class="btn btn-danger" onclick="remove_template(this)" type="button">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="pullReqTplEditor" style="height: 300px;"></div>
                        <div class="preview alert alert-secondary mt-5">
                            <pre>Start typing</pre>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="pull(pullReqTplEditor.getText(),this.form)">Pull</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div class="modal" id="importZbxModal">
        <form id="importZbxForm" disabled="">
            <div class="modal-dialog modal-dialog-scrollable modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        Import data from Zabbix
                    </div>
                    <div class="modal-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-group ">
                                    <label>Resource</label>
                                    <select class="custom-select custom-select-sm" name="resource">
                                        <option>host</option>
                                        <option>hostgroup</option>
                                        <option>template</option>
                                        <option>trigger</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Request templates</label>
                            <div class="input-group mb-2">
                                <select class="custom-select" onchange="load_req_tpl(importReqTplEditor,$(this).val())" id="importReqTemplates" name="templates"></select>
                                <div class="input-group-append">
                                    <div class="btn-group">
                                        <button class="btn btn-success" onclick="save_req_tpl(importReqTplPfx,'#importReqTemplates',importReqTplEditor)" type="button">Save</button>
                                        <button class="btn btn-danger" onclick="remove_template(this)" type="button">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="importReqTplEditor" style="height: 300px;"></div>
                        <div class="preview alert alert-secondary mt-5">
                            <pre>sadas</pre>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" data-dismiss="modal" onclick="import_zbx(importReqTplEditor.getText(),this.form)">Import</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div class="modal" id="pushZbxModal">
        <form id="pushZbxForm">
            <div class="modal-dialog modal-dialog-scrollable modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        Push data to Zabbix
                    </div>
                    <div class="modal-body">
                        <div class="form-row">
                            <div class="col">
                                <div class="form-group ">
                                    <label>Resource</label>
                                    <select class="custom-select custom-select-sm" name="resource">
                                        <option>host</option>
                                        <option>hostgroup</option>
                                        <option>template</option>
                                        <option>template</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label>Operation</label>
                                    <select class="custom-select custom-select-sm mt-1" name="operation">
                                        <option>update</option>
                                        <option>create</option>
                                        <option>delete</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label>Post process</label>
                                    <select class="custom-select custom-select-sm mt-1" name="postprocess">
                                        <option value="update">Update existing</option>
                                        <option value="new">New data</option>
                                        <option value="ignore">Ignore</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Request templates</label>
                            <div class="input-group mb-2">
                                <select class="custom-select" onchange="load_req_tpl(pushReqTplEditor,$(this).val())" id="pushReqTemplates" name="templates"></select>
                                <div class="input-group-append">
                                    <div class="btn-group">
                                        <button class="btn btn-success" onclick="save_req_tpl(pushReqTplPfx,'#pushReqTemplates',pushReqTplEditor)" type="button">Save</button>
                                        <button class="btn btn-danger" onclick="remove_template(this)" type="button">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="pushReqTplEditor" style="height: 300px;"></div>
                        <div class="preview alert alert-secondary mt-5">
                            <pre>sadas</pre>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="push(pushReqTplEditor.getText(),this.form)">Push</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div class="modal" id="importCsvModal">
        <form id="loadCvsForm">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        Load CSV file
                    </div>
                    <div class="modal-body">
                        <input type="file" name="file">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="load_csv(this.form.file)">Load</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div class="modal" id="zbxConfigModal">
        <form id="zbxConfigForm">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        Zabbix connection
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="zbxUrlInput">API URL</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <button class="btn btn-outline-secondary" type="button" onclick="load_api_url(this)">Load</button>
                                </div>
                                <input type="text" class="form-control" name="url" id="zbxUrlInput">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="zbxTokenInput">API Token</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <button class="btn btn-outline-secondary" type="button" onclick="load_api_key(this)">Load</button>
                                </div>
                                <input type="text" class="form-control" name="token" id="zbxTokenInput">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="save_zbx_config(this.form)">Save config</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </form>
    </div>



    <div class="modal" id="generic_modal">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header"></div>
                <div class="modal-body"></div>
                <div class="modal-footer">
                    <button data-dismiss="modal" class="btn btn-secondary">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="overlay" class="overlay">
        <div class="vertical-center">
            <div class="d-inline">
                <div class="spinner-border" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
        </div>
    </div>
    <div id="warning" class="overlay">
        <div class="vertical-center">
            <div class="d-inline-block text-center bg-light rounded p-5" style="width: 500px">
                <span style="font-size: 100px">&#x2620;</span>
                <h3 class="text-danger">Warning</h3>
                <p><strong>ZbxWizz</strong> is a very powerfull tool to manage large scale (and small as well)  <strong>Zabbix&trade;</strong> instalations.</p>
                <p>You can save a lot of time and get your Bo$$ appreciation (and eventually a raise or a bonus) or you can sign your death sentence by pushing the wrong commands</p>
                <p>As with great power comes great responsibility use it wisely (and on your own risk)! </p>
                <p>So wich pill will you choose?</p>
                <button class="badge-pill badge-danger" onclick="localStorage.setItem('userlevel','courageous');run()">Red pill (be brave!)</button>
                <button class="badge-pill badge-primary" onclick="alert('Sleep well!');window.close()">Blue pill (stay safe!)</button>
            </div>
        </div>
    </div>
    <div class="tab-content" id="worksheets"></div>
    <footer class="footer mt-auto fixed-bottom bg-secondary border-top border-dark">
        <div class="container-fluid p-1" >
            <div class="d-inline-block">
                <ul class="nav nav-pills" id="sheetSelector" role="tablist" data-lastassigned="1"></ul>
            </div>
            <button onclick="worksheets.new_sheet()">[+] New sheet</button>
            <button onclick="worksheets.delete_sheet()">[-] Remove current sheet</button>
            <button onclick="worksheets.reset()">[x] Reset</button>
        </div>
        <div class="container-fluid bg-dark text-success p-1">
            Status bar:
        </div>
    </footer>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/papaparse.min.js"></script>
<script src="assets/js/select2.min.js"></script>
<script src="assets/js/jsoneditor.js"></script>
<script src="assets/js/jquery-ui.js"></script>
<script src="assets/js/colResizable-1.6.min.js"></script>
<script src="lib/zbx.js"></script>
<script src="lib/datatable.js"></script>
<script src="lib/worksheets.js"></script>
<script src="lib/zbxwizz.js"></script>
</body>
</html>
